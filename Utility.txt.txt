Utility functions on third version